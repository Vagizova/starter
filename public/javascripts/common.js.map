{"version":3,"sources":["common.js"],"names":["$","getCards","ajax","url","type","done","cards","cardsPagesCount","assignId","cardsArray","length","concat","cardsLoader","masonry","masonryConfig","isMasonryCreated","newCards","map","card","createCard","append","isHeaderVisible","currentSlide","topOffset","index","height","setBorders","body","addClass","removeClass","lastIndex","id","heightCoefficient","imgHeight","imgWidth","img","name","get","itemSelector","columnWidth","percentPosition","slickConfig","dots","arrows","infinite","vertical","speed","fade","cssEase","bloggerConfig","slidesToShow","slidesToScroll","animate","scrollTop","slick","click","window","on","event","container","currentContent","find","isScrolledUp","parseInt","originalEvent","wheelDelta","detail","heightDelta","Math","floor","offset","top","document","currentSlideIdx","preventDefault"],"mappings":"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","file":"../sources/common.js","sourcesContent":["$(function() {\n    let isMasonryCreated = false;\n    let cardsLoader;\n    let cardsArray = [];\n    let masonryConfig = {\n        itemSelector: '.c-card',\n        columnWidth: '.c-card__sizer',\n        percentPosition: true,\n        // gutter: '.c-card__gutter'\n    };\n    let slickConfig = {\n        dots: false,\n        arrows: false,\n        infinite: false,\n        vertical: false,\n        speed: 800,\n        fade: true,\n        cssEase: 'linear'\n    };\n    let bloggerConfig = {\n        dots: true,\n        arrows: true,\n        infinite: false,\n        vertical: false,\n        speed: 800,\n        slidesToShow: 4,\n        slidesToScroll: 4,\n        cssEase: 'linear'\n    }\n    let cardsPagesCount = 1;\n\n    $('body').addClass('hidden-footer').animate({\n        scrollTop: $('.c-header').height()\n    }, 500);\n\n    $('.c-section-container').slick(slickConfig);\n    $('.c-bloggers-wrapper').slick(bloggerConfig);\n    getCards();\n    $('#more-cards').click(getCards);\n\n    // let previousWindowOffset = $(window).offset().top;\n    // console.log(previousWindowOffset);\n\n    $(window).on('mousewheel DOMMouseScroll MozMousePixelScroll', (event) => {\n        let container = $('.c-section-container');\n        let currentSlide = $('.c-section.slick-active');\n        let currentContent = currentSlide.find('.c-section__content');\n        let isScrolledUp = parseInt(event.originalEvent.wheelDelta || -event.originalEvent.detail) >= 0;\n        let heightDelta = Math.floor(currentContent.height() - currentSlide.height());\n        let topOffset = currentSlide.offset().top - $(document).scrollTop();\n        if (isScrolledUp) {\n            if (currentSlide.index() > 0) {\n                if (currentContent.offset().top == 0) {\n                    let currentSlideIdx = container.slick('slickCurrentSlide');\n                    container.slick('slickGoTo', currentSlideIdx - 1);\n                }\n            } else {\n                if (currentSlide.find('.c-section__box').scrollTop() <= 0) {\n                    if (isHeaderVisible(currentSlide, topOffset)) {\n                        event.preventDefault();\n                        $('body').animate({\n                            scrollTop: 0\n                        }, 500);\n                    }\n                }\n            }\n        } else {\n            if (topOffset > 0) {\n                event.preventDefault();\n                $('body').animate({\n                    scrollTop: $('.c-header').height()\n                }, 500);\n                return;\n            }\n            if (heightDelta <= currentSlide.find('.c-section__box').scrollTop() || heightDelta < 0) {\n                if (currentSlide.index() < $('.c-section').length) {\n                    let currentSlideIdx = container.slick('slickCurrentSlide');\n                    container.slick('slickGoTo', currentSlideIdx + 1);\n                }\n            }\n        }\n        setBorders($('.c-section.slick-active'));\n    });\n\n    function getCards() {\n        $.ajax({\n            url: 'http://127.0.0.1:3000/cards',\n            type: 'GET'\n        }).done((cards) => {\n            cardsPagesCount++;\n            cards = assignId(cards, cardsArray.length);\n            cardsArray = cardsArray.concat(cards);\n            if (cards.length > 0) {\n                cardsLoader = $('.c-cards-holder').masonry(masonryConfig);\n                isMasonryCreated = true;\n                let newCards = cards.map((card) => {\n                    return createCard(card);\n                });\n                cardsLoader.append(newCards).masonry('appended', newCards).masonry('reloadItems');\n            } else {\n                if (isMasonryCreated) {\n                    cardsLoader.masonry('destroy');\n                    isMasonryCreated = false;\n                }\n            }\n        })\n    }\n\n    function isHeaderVisible(currentSlide, topOffset) {\n        return currentSlide.index() == 0 && topOffset == $('.c-header').height();\n    }\n\n    function isFooterVisible(currentSlide, topOffset) {\n        return currentSlide.index() == $('.c-section').length - 1 && (-1 * topOffset) == $('.c-footer').height();\n    }\n\n    function setBorders(currentSlide) {\n        let body = $('body');\n        if (currentSlide.index() > 0) {\n            body.addClass('hidden-header');\n            body.addClass('hidden-footer');\n            if (currentSlide.index() == $('.c-section').length - 1) {\n                body.removeClass('hidden-footer');\n            }\n        } else {\n            body.addClass('hidden-footer');\n            body.removeClass('hidden-header');\n        }\n    }\n\n    function assignId(cards, lastIndex) {\n        return cards.map((card, index) => {\n            card.id = 'card-' + (lastIndex + index + 1);\n            return card;\n        })\n    }\n\n    function createCard(card) {\n        let heightCoefficient = card.imgHeight / card.imgWidth;\n        return $(\n            `<div class='c-card' id='${card.id}'>` +\n            `<div class='c-card__image'` +\n            `style='background-image: url(${card.img});'>` +\n            `<div class='c-card__image_embedded'` +\n            `style='padding-top: ${heightCoefficient ? 100 * heightCoefficient + '%' : '100%'};'></div></div>` +\n            `<div class='c-card__description'>` +\n            `<div class='c-card__name'>${card.name}</div></div></div>`\n        ).get(0);\n    };\n});"]}